<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-4.0.4 plugin-docs plugin-id-default docs-doc-id-系统配置手册/模板详细说明/安全作业模板">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="imgenius RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="imgenius Atom Feed">





<script src="/js/index.js"></script><title data-rh="true">安全作业模板 | imgenius</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://idongmobility.github.io//docs/系统配置手册/模板详细说明/安全作业模板"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="4.0.4"><meta data-rh="true" name="docusaurus_tag" content="docs-default-4.0.4"><meta data-rh="true" name="docsearch:version" content="4.0.4"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-4.0.4"><meta data-rh="true" property="og:title" content="安全作业模板 | imgenius"><meta data-rh="true" name="description" content="实现8大安全作业的定点，定人，定时，违规操作报警。"><meta data-rh="true" property="og:description" content="实现8大安全作业的定点，定人，定时，违规操作报警。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://idongmobility.github.io//docs/系统配置手册/模板详细说明/安全作业模板"><link data-rh="true" rel="alternate" href="https://idongmobility.github.io//docs/系统配置手册/模板详细说明/安全作业模板" hreflang="en"><link data-rh="true" rel="alternate" href="https://idongmobility.github.io//docs/系统配置手册/模板详细说明/安全作业模板" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.7f52b7c3.css">
<link rel="preload" href="/assets/js/runtime~main.c943c75d.js" as="script">
<link rel="preload" href="/assets/js/main.4ebc8132.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="imgenius Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="imgenius Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">imgenius</b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/简介/概述">文档</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/简介/概述">开发中（待发布）</a></li><li><a class="dropdown__link" href="/docs/简介/概述">4.0.4（最新版）</a></li><li><a class="dropdown__link" href="/docs/4.0.3/简介/概述">4.0.3</a></li><li><a class="dropdown__link" href="/docs/4.0.2/简介/概述">4.0.2</a></li><li><a class="dropdown__link" href="/docs/4.0.0/简介/概述">4.0.0</a></li><li><a class="dropdown__link" href="/docs/3.8.2/简介/概述">3.8.2</a></li></ul></div><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/发布说明/发布记录">发布记录</a><a href="http://www.idongmobility.com/index.php/zh/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">艾动官网<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/iDongMobility/imgenius-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD sidebarWithHideableNavbar_d0QC"><a tabindex="-1" class="sidebarLogo_YUvz" href="/"><img src="/img/logo.png" alt="imgenius Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="imgenius Logo" class="themedImage_W2Cr themedImage--dark_oUvU"><b>imgenius</b></a><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/简介/概述">简介</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/安装/系统要求">安装</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/用户使用手册/网页端/登录">用户使用手册</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/系统配置手册/授权管理/">系统配置手册</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/授权管理/">授权管理</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/系统配置手册/系统设置/服务/">系统设置</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/账户设置/">账户设置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/数据库管理/">数据库管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/解决方案管理/">解决方案管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/部署模型管理/">部署模型管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/解决方案设置/">解决方案设置</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/系统配置手册/列表管理器/概述">列表管理器</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/系统配置手册/组织架构管理器/概述">组织架构管理器</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/流程管理器/">流程管理器</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/系统配置手册/作业管理器/概述">作业管理器</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/系统配置手册/模板详细说明/概述">模板详细说明</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/模板详细说明/概述">概述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/模板详细说明/基础模板">基础模板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/模板详细说明/巡检和维修作业模板">巡检和维修作业模板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/系统配置手册/模板详细说明/设备管理模板">设备管理模板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/系统配置手册/模板详细说明/安全作业模板">安全作业模板</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/系统维护指南/运行监控和维护">系统维护指南</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/系统扩展指南/主页定制扩展开发">系统扩展指南</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/发布说明/发布记录">发布说明</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/故障排查指南/移动工作站">故障排查指南</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/内置函数/流程自定义函数">内置函数</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/附录/软件和应用升级">附录</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_FykI"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_DTRl"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">系统配置手册</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">模板详细说明</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">安全作业模板</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 4.0.4</span><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>安全作业模板</h1></header><p>实现8大安全作业的定点，定人，定时，违规操作报警。</p><p>具体功能实现：</p><ul><li><p>可绘制的作业范围-围栏。</p></li><li><p>终端定位作业人员，保证人员在指定范围作业。</p></li><li><p>对于需要气体检测的作业，第一次检查不是完全安全范围的，每半小时创建一个检测作业组，中途暂停作业超过1h的，也会创建检测作业组，要求人员去现场检测。</p></li><li><p>对于监护人员离场，无关人员闯入围栏范围，围栏范围人员过多，作业超时都能及时报警。</p></li><li><p>规范安全作业流程，减少作业事故发生，提高企业效益。</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>1.需要和钛准定位系统结合使用，2.需要自定义服务程序启动，3.需要与钛准系统的接口程序服务启动。</p></div></div></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="流程">流程<a class="hash-link" href="#流程" title="Direct link to heading">​</a></h2><ul><li><p>申请动火-&gt;审核-&gt;现场落实安全措施，气体检测，监护人到位-&gt;领导签名-&gt;开始动火-&gt;验收结束</p><img loading="lazy" alt=" " src="/docimg/动火流程.png" class="img_E7b_"></li><li><p>其中<em>动火计划申请</em>和<em>作业申请审核</em>主要是EOC审核，主要是对一些作业组属性进行操作。
<em>落实安全措施</em>、<em>监火人签名</em>、<em>审批签名</em>、<em>一级签名</em>、<em>安全作业</em>都是分别是安全员，监护员，主管，经理，监护员在<em>现场</em>操作。</p><p> :::warning 注意
审核签名活动名称不能更改，在这个活动时才会判断是否创建气体检测作业
:::warning 注意</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="作业">作业<a class="hash-link" href="#作业" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="落实安全措施">落实安全措施<a class="hash-link" href="#落实安全措施" title="Direct link to heading">​</a></h3><ul><li><p><a href="#dhaqcs">详见作业规范-动火安全措施</a>。</p></li><li><span id="qm">安全措施落实人签名</span>* 这里主要就是确定作业人是到围栏范围内落实安全措施了。所以有个查询此人是否在围栏范围的脚本。</li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var baseUrl = &#x27;http://&#x27; + GlobalInfo.GetSyncServer() + &#x27;:8011&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var buildId = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;buildId&#x27;) ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 查询人员</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var IsInRail = function(_name, _rail, _callback){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $.ajax({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: baseUrl + &#x27;/IsInRail?name=&#x27; + _name + &#x27;&amp;rail=&#x27; + _rail,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;get&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dataType: &#x27;json&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      timeout: 1500,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      headers: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;Content-Type&#x27;: &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      data: JSON.stringify({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;buildId&#x27;:buildId,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;railName&#x27;:_rail,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;name&#x27;:_name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      success: function(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(res &amp;&amp; res.IsOk){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback(res.Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Common.ShowDebug(JSON.stringify(res));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      error: function(XMLHttpRequest, textStatus, errorThrown){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Common.ShowDebug(errorThrown + XMLHttpRequest.responseText);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _callback();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var user = GlobalInfo.GetLoginUser();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var rail = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;作业详细地点&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">IsInRail(user.Name,rail,function(isIn){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if(isIn){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        alert(&#x27;登陆人&#x27;+ user.Name +&#x27;不在围栏内，请到达作业围栏范围内再执行作业。&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">如果查询登陆人不在范围内返回true。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var task = ScriptEngine.Context.GetTaskByID(contextID);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.Context.SetTaskAttributeValue(task.ID,&#x27;Value&#x27;,&#x27;&#x27;) ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.Context.SetTaskAttributeValue(task.ID,&#x27;Status&#x27;,JobStatus.New) ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">将作业项状态修改为未完成状态。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>结合下面作业项配置就可以做到安全员不在规定围栏范围，完成不了此项作业。</p><img loading="lazy" alt=" " src="/docimg/必须完成.png" class="img_E7b_"></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="检测人员检测">检测人员检测<a class="hash-link" href="#检测人员检测" title="Direct link to heading">​</a></h3><ul><li><p><a href="#qtjc">详见作业规范-气体检测</a>。</p></li><li><p>检测人员签名</p><ul><li>同<a href="#qm">安全措施落实人签名</a>。</li></ul></li><li><span id="zjcjg">总检测结果</span>* 将作业*检测人员检测*下所有作业项*检测结果*的值拿出来归类。只要有一次不合格则返回不合格，没有不合格有合格则返回合格，全部为安全才返回安全。</li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var context = ScriptEngine.Context;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var task0 = context.GetTaskByID(contextID);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var parent = context.GetParentTask(task0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getTasks(_parent, _name){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    var tasks = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    var getOne = function(_task){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(_task &amp;&amp; _task.ID){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            var children= context.GetChildTasks(_task.ID);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if(children &amp;&amp; children.length &gt; 0){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                for(var i=0;i &lt; children.length; i++){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    if(children[i] &amp;&amp; children[i].Name &amp;&amp; children[i].Name === _name){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tasks.push(children[i]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    getOne(children[i]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    getOne(_parent);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return tasks;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var tasks = getTasks(parent,&#x27;检测结果&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var res = @CustomList.检测结果.安全 ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tasks.forEach(function(_task){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    var value = ScriptEngine.Context.GetTaskAttributeValue(_task.ID, &#x27;Value&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if(value === &#x27;&#x27; || value === @CustomList.检测结果.不合格 ){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        res = @CustomList.检测结果.不合格 ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else if(value === @CustomList.检测结果.合格 &amp;&amp; res === @CustomList.检测结果.安全 ){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        res = value ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return res;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.Context.SetTaskGroupPropertyValue(&#x27;检测结果&#x27;,@Me.Value );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">将作业项的值更新到作业组属性*检测结果*。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var userName = &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var user = GlobalInfo.GetLoginUser();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(user)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">userName =user.Name  ; </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.Context.SetTaskGroupPropertyValue(&#x27;检测人员&#x27;,userName) ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return  true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">将登陆人的显示名更新到作业组属性*检测人员*。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="添加作业人员">添加作业人员<a class="hash-link" href="#添加作业人员" title="Direct link to heading">​</a></h3><ul><li><a href="#zyry">详见作业规范-动作业人员</a>。</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="运行监护人签名">运行监护人签名<a class="hash-link" href="#运行监护人签名" title="Direct link to heading">​</a></h3><ul><li>同<a href="#qm">安全措施落实人签名</a>。</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="审批签名">审批签名<a class="hash-link" href="#审批签名" title="Direct link to heading">​</a></h3><ul><li><p>审批人签名</p><ul><li>同<a href="#qm">安全措施落实人签名</a>。</li></ul></li><li><span id="yjlw">加监护人至越界例外</span>* 将监护人员、作业人员添加到*越界例外*名单中去，这样这些人穿过围栏进入围栏就不会报警，不在这个名称范围内的任何人穿越都会报警。</li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 将属性名对应的人添加到此作业项指定的报警人员中</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var propertyName = &#x27;运行监护人&#x27; ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var type = @Me.Value.DisplayName ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var baseUrl = &#x27;http://&#x27; + GlobalInfo.GetSyncServer() + &#x27;:8011&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 查询人员</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var getMacByName = function(_name, _callback){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $.ajax({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: baseUrl + &#x27;/GetMacByName?name=&#x27; + _name,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;get&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dataType: &#x27;json&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      headers: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;Content-Type&#x27;: &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      data: &#x27;&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      success: function(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(res &amp;&amp; res.IsOk){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback(res.Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if(res){ </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Common.ShowDebug(res.ErrorMsg);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      error: function(XMLHttpRequest, textStatus, errorThrown){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Common.ShowDebug(errorThrown + XMLHttpRequest.responseText);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var workers = ScriptEngine.Context.GetTaskGroupPropertyValue(type);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(workers){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    workers = JSON.parse(workers);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    workers = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var name = ScriptEngine.Context.GetTaskGroupPropertyValue(propertyName);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">getMacByName(name,function(mac){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if(mac){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        var isIn = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        for(var i = 0; i &lt; workers.length; i++){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if(workers[i][&#x27;胸牌ID&#x27;] === mac){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                isIn = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(isIn){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            //alert(&#x27;用户【&#x27;+name+&#x27;】已在【&#x27; + type + &#x27;】中登记，不可重复&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        workers.push({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;姓名&#x27;: name,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;胸牌ID&#x27;: mac</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine.Context.SetTaskGroupPropertyValue(type ,JSON.stringify(workers));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 将作业人员指定的报警人员中（格式相同）</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var propertyName = &#x27;作业人员&#x27; ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var type = &#x27;越界例外人员&#x27; ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var workers = ScriptEngine.Context.GetTaskGroupPropertyValue(type);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(workers){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    workers = JSON.parse(workers);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    workers = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var users = ScriptEngine.Context.GetTaskGroupPropertyValue(propertyName);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(users){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    users = JSON.parse(users);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    _.each(users, function(user){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        var find = _.find(workers, function(worker){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return worker[&#x27;胸牌ID&#x27;] === user[&#x27;胸牌ID&#x27;];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(!find)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            workers.push(user);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ScriptEngine.Context.SetTaskGroupPropertyValue(type ,JSON.stringify(workers));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return true;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>加作业负责人至越界例外</p><ul><li>同<a href="#yjlw">加监护人至越界例外</a>。</li></ul></li><li><p>加检测人员至越界例外</p><ul><li>同<a href="#yjlw">加监护人至越界例外</a>。</li></ul></li><li><p>设置报警</p><ul><li>返回true代表和钛准定位系统联通，系统所有的报警设置能够有效。</li></ul></li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var curTaskGroup = ScriptEngine.Context.GetCurTaskGroup();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var baseUrl = &#x27;http://&#x27; + GlobalInfo.GetSyncServer() + &#x27;:8011&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 查询人员</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var setAlarm = function(_taskGroupID, _callback){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $.ajax({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: baseUrl + &#x27;/SetAlarm&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;post&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dataType: &#x27;json&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      headers: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;Content-Type&#x27;: &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      data: JSON.stringify({&#x27;taskGroupID&#x27;:_taskGroupID}),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      success: function(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(res &amp;&amp; res.IsOk){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback(res.Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if(res){ </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Common.ShowDebug(res.ErrorMsg);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      error: function(XMLHttpRequest, textStatus, errorThrown){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Common.ShowDebug(errorThrown + XMLHttpRequest.responseText);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">setAlarm(curTaskGroup.ID,function(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        alert(&#x27;设置报警成功！&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="特殊动火会签">特殊动火会签<a class="hash-link" href="#特殊动火会签" title="Direct link to heading">​</a></h3><ul><li>同<a href="#qm">安全措施落实人签名</a>。</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="动火">动火<a class="hash-link" href="#动火" title="Direct link to heading">​</a></h3><ul><li>详见<a href="#dhzygf">作业规范-安全作业规范</a>。  </li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="验收">验收<a class="hash-link" href="#验收" title="Direct link to heading">​</a></h3><ul><li><p>详见<a href="#ysgf">作业规范-验收规范</a>。</p></li><li><p>监护人签字</p><ul><li>同<a href="#qm">安全措施落实人签名</a>。</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="作业规范">作业规范<a class="hash-link" href="#作业规范" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="动火安全措施"><span id="dhaqcs">动火安全措施</span><a class="hash-link" href="#动火安全措施" title="Direct link to heading">​</a></h3><ul><li>作业项的检查内容是依据客户原有纸质表格配置出来的。</li><li>添加监火人至离开关注</li><li>监护人离开围栏范围一定时间后系统报警配置。</li><li>同<a href="#yjlw">加监护人至越界例外</a>。</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="单类气体分析检测"><span id="qtjc">单类气体分析检测</span><a class="hash-link" href="#单类气体分析检测" title="Direct link to heading">​</a></h3><ul><li><p>主要是记录位置，气体类型，何种气体，含量以及是否合格。</p></li><li><p>这里可以重复创建本规范。</p></li><li><p>是否还有其他检测气体</p><img loading="lazy" alt=" " src="/docimg/气体检测.png" class="img_E7b_"></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="作业人员"><span id="zyry">作业人员</span><a class="hash-link" href="#作业人员" title="Direct link to heading">​</a></h3><ul><li><p>扫描胸牌</p><img loading="lazy" alt=" " src="/docimg/胸牌.png" class="img_E7b_"><ul><li>扫描动火人员的胸牌上二维码，系统会去查询此码的人员姓名，并将其更新到作业组属性<em>作业人员</em>。</li></ul></li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var mac = @Me.Value ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var baseUrl = &#x27;http://&#x27; + GlobalInfo.GetSyncServer() + &#x27;:8011&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 查询人员</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var getUserByMac = function(_mac, _callback){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $.ajax({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: baseUrl + &#x27;/GetLocationUserByMac?mac=&#x27; + _mac,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;get&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dataType: &#x27;json&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      headers: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;Content-Type&#x27;: &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      data: &#x27;&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      success: function(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(res &amp;&amp; res.IsOk){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback(res.Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if(res){ </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Common.ShowDebug(res.ErrorMsg);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      error: function(XMLHttpRequest, textStatus, errorThrown){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Common.ShowDebug(errorThrown + XMLHttpRequest.responseText);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _callback();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var workers = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;作业人员&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(workers){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    workers = JSON.parse(workers);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    workers = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">getUserByMac(mac,function(user){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if(user){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        var isSure = confirm(&#x27;用户名：&#x27; + user.name + &#x27;  类型：&#x27; + user.type);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(user &amp;&amp; isSure){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            var isIn = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            for(var i = 0; i &lt; workers.length; i++){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if(workers[i][&#x27;胸牌ID&#x27;] === user.mac){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    isIn = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if(isIn){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                alert(&#x27;用户【&#x27;+user.name+&#x27;】已登记，不可重复&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            workers.push({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &#x27;姓名&#x27;: user.name,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &#x27;胸牌ID&#x27;: user.mac</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine.Context.SetTaskGroupPropertyValue(&#x27;作业人员&#x27;,JSON.stringify(workers));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="还有作业人员吗"><span id="hyzyry">还有作业人员吗</span><a class="hash-link" href="#还有作业人员吗" title="Direct link to heading">​</a></h3><ul><li>重复创建此规范，可扫描多次动火人员。将作业人员信息更新到作业组属性<em>多组报警</em>中。</li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var alarmArray = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;多组报警&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(alarmArray){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    alarmArray = JSON.parse(alarmArray);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    alarmArray = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var workers = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;作业人员&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(workers){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    workers = JSON.parse(workers);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    workers = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var count = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;作业人员数&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(count){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    count = Number(count);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    count = 0;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var res = {};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">res[&#x27;Macs&#x27;] = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">res[&#x27;Count&#x27;] = count;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">res[&#x27;Type&#x27;] = &#x27;作业人员&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">workers.forEach(function(_worker){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    res[&#x27;Macs&#x27;].push(_worker[&#x27;胸牌ID&#x27;]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">alarmArray = alarmArray.concat(res);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.Context.SetTaskGroupPropertyValue(&#x27;多组报警&#x27;, JSON.stringify(alarmArray));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return true;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var p = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;作业人员&#x27;) ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var context = ScriptEngine.Context;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var value = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;作业人员&#x27;) ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var cost = &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if (value &amp;&amp; value != &#x27;&#x27;) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    var jObj = JSON.parse(value);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (jObj &amp;&amp; jObj.length &gt; 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        _.each(jObj, function(_item) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (_item[&#x27;姓名&#x27;]){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                cost +=_item[&#x27;姓名&#x27;] + &#x27;:&#x27;+ _item[&#x27;胸牌ID&#x27;] +&#x27;;&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.Context.SetTaskGroupPropertyValue(&#x27;作业人员信息&#x27;,cost ) ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return cost ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">将作业组属性*作业人员*中姓名累加更新到作业组属性*作业人员信息*。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="安全作业规范"><span id="dhzygf">安全作业规范</span><a class="hash-link" href="#安全作业规范" title="Direct link to heading">​</a></h3><ul><li>是否暂停<ul><li>动火过程中可能需要暂停工作一段时间，当需要暂停时就可以选择<em>√</em>，系统会将此作业组暂停，报警终止。</li></ul></li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var me = @Me.Value ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var baseUrl = &#x27;http://&#x27; + GlobalInfo.GetSyncServer() + &#x27;:8011&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var isPause = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(me === @CustomList.√/×.√ ) isPause = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 暂停作业</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var PauseAlarm = function(_jobID, _isPause, _callback){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $.ajax({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: baseUrl + &#x27;/PauseAlarm&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;post&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dataType: &#x27;json&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      headers: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;Content-Type&#x27;: &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      data: JSON.stringify({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;JobID&#x27;: _jobID,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;IsPause&#x27;: _isPause</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      success: function(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(res &amp;&amp; res.IsOk){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback(res.Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if(res){ </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Common.ShowDebug(res.ErrorMsg);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      error: function(XMLHttpRequest, textStatus, errorThrown){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Common.ShowDebug(errorThrown + XMLHttpRequest.responseText);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var curTaskGroup = ScriptEngine.Context.GetCurTaskGroup();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(isPause){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    PauseAlarm(curTaskGroup.ID,isPause,function(isOk){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(isOk){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">else ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">暂停成功返回true。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var task = ScriptEngine.Context.GetTaskByID(contextID);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var parent = ScriptEngine.Context.GetParentTask(task);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var taskItem = ScriptEngine.Context.GetTaskByNameAndParent(&#x27;作业&#x27;,parent.ID);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.Context.SetTaskAttributeValue(taskItem.ID,&#x27;AssetID&#x27;,&#x27;9c39d6bc-e075-4b85-8e55-17a9e39f8eac&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">alert(&#x27;暂停成功。&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">选择暂停后将作业规范下作业*作业*修改为不可执行状态。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>是否恢复作业</p><ul><li>暂停过后，如果开始作业了，选择<em>√</em>，系统又开始报警。如果中间休息超过<strong>1H</strong>，则创建作业组<em>暂停后气体检测作业</em>。</li></ul><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>注意</h5></div><div class="admonition-content"><p>创建作业组必须和自定义服务一起使用。</p></div></div></li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var baseUrl = &#x27;http://&#x27; + GlobalInfo.GetSyncServer() + &#x27;:8011&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 创建气体检测</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var CreateTest = function(_taskGroupID, _callback){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    $.ajax({</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      url: baseUrl + &#x27;/CreateTest&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      type: &#x27;post&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dataType: &#x27;json&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      headers: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;Content-Type&#x27;: &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      data: JSON.stringify({&#x27;TaskGroupID&#x27;:_taskGroupID}),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      success: function(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(res &amp;&amp; res.IsOk){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback(res.Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if(res){ </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Common.ShowDebug(res.ErrorMsg);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      error: function(XMLHttpRequest, textStatus, errorThrown){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Common.ShowDebug(errorThrown + XMLHttpRequest.responseText);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var pause = @暂停.TimeStamp ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var now = new Date();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//超过1小时</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(now.getTime() - pause.getTime() &gt; 3600 * 1000){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    var tg = ScriptEngine.Context.GetCurTaskGroup();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    CreateTest(tg.ID,function(isOk){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(isOk)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">else </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var task = ScriptEngine.Context.GetTaskByID(contextID);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var parent = ScriptEngine.Context.GetParentTask(task);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var taskItem = ScriptEngine.Context.GetTaskByNameAndParent(&#x27;作业&#x27;,parent.ID);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.Context.SetTaskAttributeValue(taskItem.ID,&#x27;AssetID&#x27;,&#x27;00000000-0000-0000-0000-000000000000&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return &#x27;恢复成功&#x27; ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">将作业规范下作业*作业*修改为可执行状态。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>安全作业完成了吗<ul><li>同<a href="#qm">安全措施落实人签名</a>。回答问题时一定要处于规定围栏范围内。</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="验收规范"><span id="ysgf">验收规范</span><a class="hash-link" href="#验收规范" title="Direct link to heading">​</a></h3><ul><li>安装客户需求配置检查项即可。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="作业组属性">作业组属性<a class="hash-link" href="#作业组属性" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="基本信息">基本信息<a class="hash-link" href="#基本信息" title="Direct link to heading">​</a></h3><img loading="lazy" alt=" " src="/docimg/作业组属性-基本信息.png" class="img_E7b_"><ul><li>作业内容<ul><li>由申请人填写一些基本信息。</li></ul></li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 修改作业组属性*作业票号*为年月日时分秒。</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(this);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var ticketNo = Commons.GetSystemDateTime(&#x27;yyyy-MM-dd hh:mm:ss&#x27;).substring(2).replace(/-/g,&#x27;&#x27;).replace(/\s/g,&#x27;&#x27;).replace(/:/g,&#x27;&#x27;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.Context.SetTaskGroupPropertyValue(&#x27;作业票号&#x27;,ticketNo);</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var userID = this.parent.USERID;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.GetAjaxToApiServer(&#x27;UserConfig&#x27;,&#x27;GetByID&#x27;,&#x27;id=&#x27; + userID,&#x27;get&#x27;,&#x27;&#x27;,function(user){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if(user){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine.Context.SetTaskGroupPropertyValue(&#x27;申请人&#x27;,user.Name);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine.GetAjaxToApiServer(&#x27;UserConfig&#x27;,&#x27;GetRoles&#x27;,&#x27;userID=&#x27; + userID,&#x27;get&#x27;,&#x27;&#x27;,function(roles){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if(roles){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if(roles.length &gt; 0){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ScriptEngine[resultName] = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine[resultName] = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">修改申请人为当前登陆人的用户名。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>作业详细地点<ul><li>申请人确定作业范围-画围栏。</li></ul></li></ul><img loading="lazy" alt=" " src="/docimg/画围栏.png" class="img_E7b_"><p><code>http://111.59.194.26:8085/implant/DrawPoints.html?username=client&amp;secret=fdbc79d7a4b94f80b8c2d8aa2ea03a0e&amp;buildId=200812&amp;tokenID=IMTOKENID&amp;locationId=IMVALUE
（这是钛准定位的画围栏地址）</code></p><ul><li><p>作业票号</p><ul><li>作业内容填写完成后更新。</li></ul></li><li><p>作业点归属单位  </p></li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 得到“XX公司”列表</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(this);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var parentID = &#x27;67244b22-de4c-42c1-aba0-10bba9f2577e&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.GetAjaxToApiServer(&#x27;OrgUnit&#x27;,&#x27;GetChildren&#x27;,&#x27;parentID=&#x27; + parentID,&#x27;&#x27;,&#x27;get&#x27;,function(orgUnits){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if(orgUnits){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine[resultName] = orgUnits;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine[resultName] = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*67244b22-de4c-42c1-aba0-10bba9f2577e*为组织单元*XX公司*的ID号。</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>作业人员数</p><ul><li>预计的可能动火人员数。</li></ul></li><li><p>作业人员</p><ul><li>作业项脚本更新。详见<a href="#zyry">作业规范-作业人员</a>。</li></ul></li><li><p>作业负责人</p><ul><li>在组织单元为作业组属性<em>作业点归属单位</em>，岗位为车间主任的所有人员中选择。</li></ul></li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 过滤出特定岗位ID是的用户</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function UserFilter(_users, _postID, _callback){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    var res = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function getOne(_index){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(_index &gt;= _users.length){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback(res);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine.GetAjaxToApiServer(&#x27;UserConfig&#x27;,&#x27;GetRoles&#x27;,&#x27;userID=&#x27; + _users[_index].ID,&#x27;&#x27;,&#x27;get&#x27;,function(roles){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if(roles){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    let role = _.find(roles,function(item){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        return item.RelatedPost.ID === _postID;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    if(role)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        res.push(_users[_index]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    _index++;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    getOne(_index);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    _callback();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    getOne(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 得到“作业单位”下的特定岗位的用户列表</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(this);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//ScriptEngine.CheckTimes = 100 ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var orgUnitName = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;作业点归属单位&#x27;); //组织单元名</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var postID = &#x27;4baadf33-e82c-4d52-a026-1e52a64fabb3&#x27;;    //岗位车间主任ID</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">try{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(orgUnitName){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ScriptEngine.GetAjaxToApiServer(&#x27;OrgUnit&#x27;,&#x27;GetByName&#x27;,&#x27;parentID=invalid&amp;name=&#x27; + orgUnitName,&#x27;&#x27;,&#x27;get&#x27;,function(orgUnit){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(orgUnit){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine.GetAjaxToApiServer(&#x27;UserConfig&#x27;,&#x27;GetByOrgUnitID&#x27;,&#x27;orgUnitID=&#x27; + orgUnit.ID,&#x27;&#x27;,&#x27;get&#x27;,function(users){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if(users){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    UserFilter(users, postID, function(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        ScriptEngine[resultName] = res;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}catch(e){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.error(e);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>运行监护人<ul><li>在组织单元为作业组属性<em>作业点归属单位</em>，岗位为车间监护的所有人员中选择。</li></ul></li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 过滤出特定岗位ID是的用户</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">function UserFilter(_users, _postID, _callback){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    var res = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    function getOne(_index){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(_index &gt;= _users.length){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            _callback(res);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine.GetAjaxToApiServer(&#x27;UserConfig&#x27;,&#x27;GetRoles&#x27;,&#x27;userID=&#x27; + _users[_index].ID,&#x27;&#x27;,&#x27;get&#x27;,function(roles){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if(roles){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    let role = _.find(roles,function(item){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        return item.RelatedPost.ID === _postID;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    if(role)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        res.push(_users[_index]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    _index++;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    getOne(_index);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                else{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    _callback();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    getOne(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 得到“作业单位”下的特定岗位的用户列表</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(this);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//ScriptEngine.CheckTimes = 100 ;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var orgUnitName = ScriptEngine.Context.GetTaskGroupPropertyValue(&#x27;作业点归属单位&#x27;); //组织单元名</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var postID = &#x27;44a93fc7-91d8-4b9e-8f09-24fa7ed5f6fa&#x27;;    //岗位车间监护ID</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">try{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if(orgUnitName){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ScriptEngine.GetAjaxToApiServer(&#x27;OrgUnit&#x27;,&#x27;GetByName&#x27;,&#x27;parentID=invalid&amp;name=&#x27; + orgUnitName,&#x27;&#x27;,&#x27;get&#x27;,function(orgUnit){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if(orgUnit){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ScriptEngine.GetAjaxToApiServer(&#x27;UserConfig&#x27;,&#x27;GetByOrgUnitID&#x27;,&#x27;orgUnitID=&#x27; + orgUnit.ID,&#x27;&#x27;,&#x27;get&#x27;,function(users){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                if(users){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    UserFilter(users, postID, function(res){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        ScriptEngine[resultName] = res;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}catch(e){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.error(e);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>落实安全措施人<ul><li>选择所有岗位为<em>安全专员</em>的人员列表。</li></ul></li></ul><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 得到特定岗位的用户列表</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(this);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var resultName = ScriptEngine.GetResultName();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var postID = &#x27;c79dc247-7d6b-4782-8c21-272855ff3e5c&#x27;;    //岗位安全专员ID</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ScriptEngine.GetAjaxToApiServer(&#x27;UserConfig&#x27;,&#x27;GetByPostID&#x27;,&#x27;postID=&#x27; + postID,&#x27;&#x27;,&#x27;get&#x27;,function(users){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ScriptEngine[resultName] = new Array();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if(users){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ScriptEngine[resultName] = users;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">return {&#x27;ResultName&#x27;:resultName};</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>检测人员</p><ul><li>作业项脚本更新，<a href="#zjcjg">详情链接。</a></li></ul></li><li><p>作业等级</p><ul><li>申请后审核人员选择字符串列表。影响最终的现场审核，一级动火及以上是非常危险且严格，所以通常要上报总经理级别。</li></ul></li></ul><img loading="lazy" alt=" " src="/docimg/作业等级.png" class="img_E7b_"><p><code>[{&#x27;Name&#x27;:&#x27;特级&#x27;},{&#x27;Name&#x27;:&#x27;一级&#x27;},{&#x27;Name&#x27;:&#x27;二级&#x27;}]</code></p><ul><li><p>作业方式</p><ul><li>申请人申请时选择列表。</li></ul></li><li><p>作业方式补充</p><ul><li>申请人申请时可选择可输入列表。</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="设备交出单位风险识别">设备交出单位风险识别<a class="hash-link" href="#设备交出单位风险识别" title="Direct link to heading">​</a></h3><ul><li>作业中所接触的物质<ul><li>作业票申请后审核人选择列表。</li></ul></li><li>作业中所接触的物质补充<ul><li>作业票申请后审核人可选择可输入列表。</li></ul></li><li>危害识别<ul><li>申请人申请时选择列表。</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="报警">报警<a class="hash-link" href="#报警" title="Direct link to heading">​</a></h3><ul><li><p>此分组为报警参数设置，钛准定位系统会读取这些作业组属性。</p><ul><li><p>报警配置</p><ul><li><p>钛准系统所有报警的种类。如果值是<em>√</em>则代表启动此报警。</p><img loading="lazy" alt=" " src="/docimg/报警种类.png" class="img_E7b_"></li></ul></li></ul></li><li><p>领取物品，领取物品详情，设备</p><ul><li>这些属性是为动火装备的领取装备的，预想是这些物品也有定位卡牌。暂时没有实现。</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="报警参数">报警参数<a class="hash-link" href="#报警参数" title="Direct link to heading">​</a></h3><ul><li><p>此分组为报警参数具体配置，钛准定位系统会读取这些作业组属性。</p><img loading="lazy" alt=" " src="/docimg/报警具体设置.png" class="img_E7b_"><img loading="lazy" alt=" " src="/docimg/钛准系统报警.png" class="img_E7b_"></li><li><p>作业暂停超时阈值</p><ul><li>默认值为60分钟，超过此时间，钛准系统会报警。</li></ul></li><li><p>火票许可证过期阈值</p><ul><li>默认值为480分钟，作业组创建后超过此时间，钛准系统会报警。</li></ul></li><li><p>未开始作业阈值</p><ul><li>默认值为120分钟，从作业组创建时间开始，此时间段内没有开始流程<em>安全作业</em>，钛准系统会报警提醒。</li></ul></li><li><p>超员</p><ul><li>默认值为3人0分钟，代表围栏范围只要超过3人，钛准系统会报警。</li></ul></li><li><p>静止关注人员</p><ul><li>指围栏范围内钛准系统关注静止不动的人员名单。</li></ul></li><li><p>静止时间阈值</p><ul><li>默认值为30分钟，静止关注人员的最大静止不动时间。</li></ul></li><li><p>离开关注人员</p><ul><li>离开围栏时报警人员名单。作业项脚本更新。<a href="#dhaqcs">详见作业规范-动火安全措施</a>。</li></ul></li><li><p>离开时间阈值</p><ul><li>默认值为10分钟，离开关注人员离开围栏的最大时间，超过钛准系统会报警。</li></ul></li><li><p>超员例外人员</p><ul><li>在围栏范围但不计算在超员名单的人员清单。</li></ul></li><li><p>越界例外人员</p><ul><li>可以随意进出围栏不会导致钛准系统报警的人员清单。</li></ul></li><li><span id="dzbj">多组报警</span>* 人员机具报警的依据，如下图只有一个Mac地址，但是要求数量为2，肯定会报警。<img loading="lazy" alt=" " src="/docimg/多组报警.png" class="img_E7b_"></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="审核">审核<a class="hash-link" href="#审核" title="Direct link to heading">​</a></h3><ul><li><p>安全作业申请审核</p><ul><li><p>流程活动<em>作业申请审核</em>审核时填写。</p><img loading="lazy" alt=" " src="/docimg/安全作业审核.png" class="img_E7b_"></li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="缺省分组">缺省分组<a class="hash-link" href="#缺省分组" title="Direct link to heading">​</a></h3><ul><li><p>作业人员信息</p><ul><li><a href="#hyzyry">作业项脚本更新链接</a>。</li></ul></li><li><p>作业人员姓名</p><ul><li>无用，可以删除。</li></ul></li><li><p>检测结果</p><ul><li>主要作用是作为<strong>自定义服务</strong>是否创建作业组<em>气体检测作业</em>的依据。<a href="#zjcjg">作业项脚本更新链接</a>。</li></ul></li><li><p>buildId</p><ul><li>钛准定位系统中地图建筑的ID号。</li></ul></li><li><p>$DisplayTemplate</p><ul><li>作业组WORD视图的模板文件。</li></ul></li><li><p>$ValueOnNoExist</p><ul><li>形成模板文件时如果出现错误时显示的值。</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="演示">演示<a class="hash-link" href="#演示" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="计划申请">计划申请<a class="hash-link" href="#计划申请" title="Direct link to heading">​</a></h3><img loading="lazy" alt=" " src="/docimg/计划申请.png" class="img_E7b_"><ul><li>作业组创建后，在钛准定位系统也会对应显示.</li></ul><img loading="lazy" alt=" " src="/docimg/钛准显示1.png" class="img_E7b_"><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="作业申请审核">作业申请审核<a class="hash-link" href="#作业申请审核" title="Direct link to heading">​</a></h3><img loading="lazy" alt=" " src="/docimg/申请审核.png" class="img_E7b_"><img loading="lazy" alt=" " src="/docimg/钛准显示2.png" class="img_E7b_"><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="落实安全措施-1">落实安全措施<a class="hash-link" href="#落实安全措施-1" title="Direct link to heading">​</a></h3><ul><li>终端执行时，规定人员不在围栏范围会提示<em>请到达作业围栏范围内再执行作业。</em>。</li></ul><img loading="lazy" alt=" " src="/docimg/钛准显示3.png" class="img_E7b_"><img loading="lazy" alt=" " src="/docimg/终端显示1.png" class="img_E7b_"><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="气体检测">气体检测<a class="hash-link" href="#气体检测" title="Direct link to heading">​</a></h3><img loading="lazy" alt=" " src="/docimg/终端显示2.png" class="img_E7b_"><ul><li><p>检测合格后每半小时会创建一个气体检测作业组。</p><img loading="lazy" alt=" " src="/docimg/计划气体检测.png" class="img_E7b_"></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="审批签名-1">审批签名<a class="hash-link" href="#审批签名-1" title="Direct link to heading">​</a></h3><ul><li><p>当领导在围栏范围之内后，就可以完成作业了。</p><img loading="lazy" alt=" " src="/docimg/农主任地图.png" class="img_E7b_"></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="安全作业">安全作业<a class="hash-link" href="#安全作业" title="Direct link to heading">​</a></h3><ul><li><p>此时已经可以开始具体的动火作业了，报警也开始启动。</p><img loading="lazy" alt=" " src="/docimg/钛准显示4.png" class="img_E7b_"></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="报警-1">报警<a class="hash-link" href="#报警-1" title="Direct link to heading">​</a></h3><ul><li><p>其中<em>人员机具不合格报警是由</em><a href="#dzbj">多组报警</a>决定的。</p><img loading="lazy" alt=" " src="/docimg/钛准报警.png" class="img_E7b_"></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="钛准定位系统查看作业组信息">钛准定位系统查看作业组信息<a class="hash-link" href="#钛准定位系统查看作业组信息" title="Direct link to heading">​</a></h3><img loading="lazy" alt=" " src="/docimg/钛准查看作业票.png" class="img_E7b_"><img loading="lazy" alt=" " src="/docimg/作业票详情.png" class="img_E7b_"><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="安全作业执行">安全作业执行<a class="hash-link" href="#安全作业执行" title="Direct link to heading">​</a></h3><img loading="lazy" alt=" " src="/docimg/暂停成功.png" class="img_E7b_"><img loading="lazy" alt=" " src="/docimg/钛准已完成.png" class="img_E7b_"></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/iDongMobility/imgenius-docs/edit/master/versioned_docs/version-4.0.4/系统配置手册/模板详细说明/安全作业模板.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-12-15T01:39:06.000Z">12/15/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/系统配置手册/模板详细说明/设备管理模板"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">设备管理模板</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/系统维护指南/运行监控和维护"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">运行监控和维护</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#流程" class="table-of-contents__link toc-highlight">流程</a></li><li><a href="#作业" class="table-of-contents__link toc-highlight">作业</a><ul><li><a href="#落实安全措施" class="table-of-contents__link toc-highlight">落实安全措施</a></li><li><a href="#检测人员检测" class="table-of-contents__link toc-highlight">检测人员检测</a></li><li><a href="#添加作业人员" class="table-of-contents__link toc-highlight">添加作业人员</a></li><li><a href="#运行监护人签名" class="table-of-contents__link toc-highlight">运行监护人签名</a></li><li><a href="#审批签名" class="table-of-contents__link toc-highlight">审批签名</a></li><li><a href="#特殊动火会签" class="table-of-contents__link toc-highlight">特殊动火会签</a></li><li><a href="#动火" class="table-of-contents__link toc-highlight">动火</a></li><li><a href="#验收" class="table-of-contents__link toc-highlight">验收</a></li></ul></li><li><a href="#作业规范" class="table-of-contents__link toc-highlight">作业规范</a><ul><li><a href="#动火安全措施" class="table-of-contents__link toc-highlight"><span id="dhaqcs">动火安全措施</span></a></li><li><a href="#单类气体分析检测" class="table-of-contents__link toc-highlight"><span id="qtjc">单类气体分析检测</span></a></li><li><a href="#作业人员" class="table-of-contents__link toc-highlight"><span id="zyry">作业人员</span></a></li><li><a href="#还有作业人员吗" class="table-of-contents__link toc-highlight"><span id="hyzyry">还有作业人员吗</span></a></li><li><a href="#安全作业规范" class="table-of-contents__link toc-highlight"><span id="dhzygf">安全作业规范</span></a></li><li><a href="#验收规范" class="table-of-contents__link toc-highlight"><span id="ysgf">验收规范</span></a></li></ul></li><li><a href="#作业组属性" class="table-of-contents__link toc-highlight">作业组属性</a><ul><li><a href="#基本信息" class="table-of-contents__link toc-highlight">基本信息</a></li><li><a href="#设备交出单位风险识别" class="table-of-contents__link toc-highlight">设备交出单位风险识别</a></li><li><a href="#报警" class="table-of-contents__link toc-highlight">报警</a></li><li><a href="#报警参数" class="table-of-contents__link toc-highlight">报警参数</a></li><li><a href="#审核" class="table-of-contents__link toc-highlight">审核</a></li><li><a href="#缺省分组" class="table-of-contents__link toc-highlight">缺省分组</a></li></ul></li><li><a href="#演示" class="table-of-contents__link toc-highlight">演示</a><ul><li><a href="#计划申请" class="table-of-contents__link toc-highlight">计划申请</a></li><li><a href="#作业申请审核" class="table-of-contents__link toc-highlight">作业申请审核</a></li><li><a href="#落实安全措施-1" class="table-of-contents__link toc-highlight">落实安全措施</a></li><li><a href="#气体检测" class="table-of-contents__link toc-highlight">气体检测</a></li><li><a href="#审批签名-1" class="table-of-contents__link toc-highlight">审批签名</a></li><li><a href="#安全作业" class="table-of-contents__link toc-highlight">安全作业</a></li><li><a href="#报警-1" class="table-of-contents__link toc-highlight">报警</a></li><li><a href="#钛准定位系统查看作业组信息" class="table-of-contents__link toc-highlight">钛准定位系统查看作业组信息</a></li><li><a href="#安全作业执行" class="table-of-contents__link toc-highlight">安全作业执行</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/安装/系统要求">安装</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/用户使用手册/网页端/登录">用户使用手册</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/系统配置手册/授权管理">系统配置手册</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/系统维护指南/运行监控和维护">系统维护指南</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/系统扩展指南/主页定制扩展开发">系统扩展指南</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://gitter.im/iDongMobility/imgenius-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://weibo.com/idongmobility" target="_blank" rel="noopener noreferrer" class="footer__link-item">微博<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://mp.weixin.qq.com/s/eLjZg1xII3Zchg00Z44ZCQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">微信<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/idong-mobility-technologies/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://www.idongmobility.com/index.php/zh/clients.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">客户故事<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="http://www.idongmobility.com/index.php/zh/about.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">联系我们<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 上海艾动信息科技有限公司 Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c943c75d.js"></script>
<script src="/assets/js/main.4ebc8132.js"></script>
</body>
</html>