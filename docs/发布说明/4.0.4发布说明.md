
import useBaseUrl from '@docusaurus/useBaseUrl';

发布时间：待发布

## 增加的功能

1. [PBIN1130：增加实体结构关系图](#pbin1130：增加实体结构关系图)
1. [PBIN1871：作业树导出也支持PDF，同时可以控制导出的模式](#pbin1871：作业树导出也支持pdf，同时可以控制导出的模式)
1. [PBIN2329：活动实例支持配置禁用重新计划和审核意见](#pbin2329：活动实例支持配置禁用重新计划和审核意见)
1. [PBIN2426：终端物料图片支持点击查看](#pbin2426：终端物料图片支持点击查看)
1. [PBIN2433：imgenius对接Thingsboard时支持OPCServer数据源](#pbin2433：imgenius对接thingsboard时支持opcserver数据源)
1. [PBIN2523：EOC增加本年初和本年末的时间筛选选项](#pbin2523：eoc增加本年初和本年末的时间筛选选项)
1. [PBIN2527：资产作业报表和历史报表增加创建时间列和计划执行人列，时间筛选改成按创建时间](#pbin2527：资产作业报表和历史报表增加创建时间列和计划执行人列，时间筛选改成按创建时间)
1. [PBIN2546：客户端可以独立设置MongoDB连接方式](#pbin2546：客户端可以独立设置mongodb连接方式)
1. [PBIN2668：运营日志Web端支持@用户和前置处理](#pbin2668：运营日志web端支持@用户和前置处理)
1. [PBIN2674：增加流程后函数](#pbin2674：增加流程后函数)
1. [PBIN2761：库存导出和导入模板统一](#pbin2761：库存导出和导入模板统一)
1. [PBIN2821：报表表格模板功能增强](#pbin2821：报表表格模板功能增强)
1. [PBIN2827：物料表缩略图显示小图](#pbin2827：物料表缩略图显示小图)
1. [PBIN2831：作业组库存操作属性支持导入](#pbin2831：作业组库存操作属性支持导入)
1. [PBIN2835：EOC排班表支持导入](#pbin2835：eoc排班表支持导入)
1. [PBIN2837：可选项脚本支持显示额外信息列](#pbin2837：可选项脚本支持显示额外信息列)
1. [PBIN2859：增加操作和访问日志](#pbin2859：增加操作和访问日志)
1. [PBIN2871：图形可视化对接Thingsboard](#pbin2871：图形可视化对接thingsboard)
1. [PBIN2881：作业组属性报表遵循“仅查看自己包含的组织单元”规则](#pbin2881：作业组属性报表遵循“仅查看自己包含的组织单元”规则)
1. [PBIN2882：终端创建的规范只有创建人在当前活动时才能删除，后续不能再删除](#pbin2882：终端创建的规范只有创建人在当前活动时才能删除，后续不能再删除)
1. [PBIN2906：库存物料表自定义属性功能增强](#pbin2906：库存物料表自定义属性功能增强)
1. [PBIN2908：优化SDC用户的删除和剪切](#pbin2908：优化SDC用户的删除和剪切)
1. [PBIN2909：知识库添加附件在线预览功能增强](#pbin2909：知识库添加附件在线预览功能增强)
1. [PBIN2910：SDC导出和导入时同时包含文件](#pbin2910：SDC导出和导入时同时包含文件)
1. [PBIN2911：资产总览页面历史作业支持筛选](#pbin2911：资产总览页面历史作业支持筛选)
1. [PBIN2912：资产和资产类别的属性SDC支持批量添加](#pbin2912：资产和资产类别的属性SDC支持批量添加)
1. [PBIN2917：优化内置库存操作](#pbin2917：优化内置库存操作)
1. [PBIN2918：终端支持库存信息查询](#pbin2918：终端支持库存信息查询)
1. [PBIN2919：Web端物料图像显示最大像素不超过600px](#pbin2919：Web端物料图像显示最大像素不超过600px)
1. [PBIN2970：终端增加静默同步和同步日志](#pbin2970：终端增加静默同步和同步日志)
1. [PBIN2972：项目管理功能增强](#pbin2972：项目管理功能增强)
1. [PBIN2980：优化子项模板资产树，同时支持搜索](#pbin2980：优化子项模板资产树，同时支持搜索)
1. [PBIN2995：增强审核和执行相关消息，同时增加消息订阅的处理](#pbin2995：增强审核和执行相关消息，同时增加消息订阅的处理)
1. [PBIN3026：终端有新消息时有语音提示](#pbin3026：终端有新消息时有语音提示)
1. [PBIN3039：终端审核页面支持分组](#pbin3039：终端审核页面支持分组)
1. [PBIN3040：库存除掉没有选中任何条目的时候默认删除全部](#pbin3040：库存除掉没有选中任何条目的时候默认删除全部)
1. [PBIN3049：库存和库存条目表支持模糊查找](#pbin3049：库存和库存条目表支持模糊查找)
1. [PBIN3063：增强系统安全性](#pbin3063：增强系统安全性)
1. [PBIN3066：终端标签支持加密写入和设置为只读](#pbin3066：终端标签支持加密写入和设置为只读)
1. [PBIN3078：终端脚本增强](#pbin3078：终端脚本增强)
1. [PBIN3112：Json类型内置库操作的操作项中显示物料名和物料号](#pbin3112：Json类型内置库操作的操作项中显示物料名和物料号)
1. [PBIN3114：终端作业项和作业组属性样式修改](#pbin3114：终端作业项和作业组属性样式修改)
1. [PBIN3123：终端网站项目链接地址能直接指向甘特图](#pbin3123：终端网站项目链接地址能直接指向甘特图)
1. [PBIN3125：API登录接口有角色权限控制](#pbin3125：API登录接口有角色权限控制)
1. [PBIN3127：批量发布计划时开始时间小于当前时间的计划不会发布](#pbin3127：批量发布计划时开始时间小于当前时间的计划不会发布)
1. [PBIN3134：Web端简化执行页面](#pbin3134：web端简化执行页面)

## 修复的问题

1. BugN2422：部分操作没有记录最后修改人员
1. BugN2425：终端库操作中项信息异常
1. BugN2427：SDC中若点开的实体过多在中间被隐藏后，再次点击该实体后对该实体所做的修改失效
1. BugN2487：EOC主页中选择的数据源中带有物料图像时，显示过大
1. BugN2488：EOC中表格调整列排序后另存，在主页中选择该数据源，列排序为未调整的顺序
1. BugN2597：报表中，使用表格模板没有作业组属性
1. BugN2599：审核报表自定义模板不支持多个作业组同时审核
1. BugN2601：Web端计划页面重复计划显示样式不正确
1. BugN2604：SQLite模式中作业组属性值的最后一位符号是$符，不能保存
1. BugN2641：EOC中在复制出的自定义导航中改变查询，原导航也会改变
1. BugN2723：EOC中作业项历史报表导出显示不正确
1. BugN2807：打开作业组直接跳转到作业组属性页面的脚本，数据无法保存
1. BugN2847：作业树特殊视图中模板文件名如果含有#将导致无法下载
1. BugN2883：资产总览、人员总览另存、保存不起作用
1. BugN2958：SDC中作业勾选了“子节点在视图上为本层”后，终端显示后脚本不起作用
1. BugN3016：重复计划显示不正确
1. BugN3027：终端的多行文本作业组属性审核一次后，文字在审核页面显示不同
1. BugN3054：EOC作业树特殊视图有些情况下文件会被锁定
1. BugN3067：完成率值为0，统一处理项目中完成率
1. BugN3071：获取子项模板没有筛选资产
1. BugN3084：终端审核时，文件类型的作业组属性增加照片，Web端查看提示不存在
1. BugN3106：按天重复的计划中，作业组创建后将时间改为跨天，其之后的计划会整体往后推移一天
1. BugN3110：作业组创建后审核，如果选择后退状态将一直停留在有待计划

## 增加的功能详细说明

### PBIN1130：增加实体结构关系图

* 引入了支持实体结构关系图的配置，允许建立实体之间的任意关系，可视化配置实体之间的结构关系。

* 实体之间可以建立多个关系，每个关系为一类实体和一类实体之间的关系。条件为输出实体的一些通用信息和所有属性，其中部分为内置属性，比如位置，不必在SDC的实体中新建，操作为条件发生变化时的行为，参数是输入实体发生操作行为时所对应的内容。

   <img alt=" " src={useBaseUrl('docimg/guanlianguanxi1.png')} />

* 举例图中所示，当服务机柜的资产号、最近故障时间、润滑寿命等属性值发生了变化之后，会触发更新墨水屏的操作，根据墨水屏对应的参数，去对墨水屏进行更新，更新完毕后墨水屏的屏幕上显示的信息就会是新的属性值了。

* 实体结构关系图需要在iis中新建为一个网站，新建为网站后可以通过压缩CustomReport.xml文件，在EOC端系统扩展管理中添加为自定义报表。

   <img alt=" " src={useBaseUrl('docimg/guanlianguanxi2.png')} />

### PBIN1871：作业树导出也支持PDF，同时可以控制导出的模式

* 作业树的导出功能增强，现在支持导出为PDF格式。

* 在SDC设置中新增了作业组不支持下载源文件选项，勾选上之后，在作业组属性里使用的word和excel模板在EOC上导出时会自动以PDF格式导出，如未勾选则还是源文件格式。

   <img alt=" " src={useBaseUrl('docimg/zuoyeshudaochupdf.png')} />

   <img alt=" " src={useBaseUrl('docimg/zuoyeshudaochupdf2.png')} />

### PBIN2329：活动实例支持配置禁用重新计划和审核意见

* 在SDC的设置和业务流程实例属性中，为审核活动新增禁用重新计划和审核意见的配置。分别为禁用重新计划、重新计划必填、禁用审核意见、审核意见必填。

   <img alt=" " src={useBaseUrl('docimg/shenhejinyong1.png')} />

* 禁用和必填只能选择其中一个，选择后当流程进行到该审核活动实例时，审核负责人选择退回或后退，那么其中的审核意见和重新计划会是配置后的情况

   <img alt=" " src={useBaseUrl('docimg/shenhejinyong2.png')} />

   <img alt=" " src={useBaseUrl('docimg/shenhejinyong3.png')} />

* 注意：设置和业务流程中有一个地方做了配置，就可以生效，禁用的优先级大于必填。

### PBIN2426：终端物料图片支持点击查看

* 在终端上选择或查看物料时，可以对物料的图片进行点击查看，方便确认。

   <img alt=" " src={useBaseUrl('docimg/wuliaotupian.png')} />

### PBIN2433：imgenius对接Thingsboard时支持OPCServer数据源

* 在imgenius与Thingsboard对接时，增加了外部属性值的数据源是OPCServer的支持。

* 同数据源是MQTTServer一样，为资产新建外部属性，填写外部属性标签，此标签要与Server端定的标签一致。通过OPCClient应用连接上OPCServer，然后同步数据即可。

   <img alt=" " src={useBaseUrl('docimg/opc2.png')} />

   <img alt=" " src={useBaseUrl('docimg/opc1.png')} />

* 这样thingsboard遥测属性中就有了这几个属性的值，SDC中配置关联了这几个属性值的作业项，当通过im移动工作站执行工单时，就可以获取这些动态属性值为作业项的值了

   <img alt=" " src={useBaseUrl('docimg/opc3.png')} />

### PBIN2523：EOC增加本年初和本年末的时间筛选选项

* EOC端在所有的时间筛选框选项内，新增加了本年初和本年末的选择。

   <img alt=" " src={useBaseUrl('docimg/nianchunianmo.png')} />

### PBIN2527：资产作业报表和历史报表增加创建时间列和计划执行人列，时间筛选改成按创建时间

* 报表中的资产作业活动报表及资产作业历史报表中，新增加了两列：计划执行人列和创建时间列。同时时间筛选框中的筛选改成了创建时间。

   <img alt=" " src={useBaseUrl('docimg/zichanzuoyebaobiao.png')} />

### PBIN2546：客户端可以独立设置MongoDB连接方式

* 在SMC的属性中，新增了本地连接MongoDB数据库的功能，在一些复杂的网络环境下，可以为客户端设置独立的MongoDB连接方式。

   <img alt=" " src={useBaseUrl('docimg/mongodulishezhi.png')} />

### PBIN2674：增加流程后函数

* 新增加了两个流程后函数：
  * UpdateActivityPeriod2TaskGroupProperty
  * UpdatePeriodOfActivityToCurActivity2TaskGroupProperty

* 关于这两个流程后函数的说明和使用，请查看[流程自定义函数](/内置函数/流程自定义函数.md)，下载文档后，其中的1.33和1.34。

### PBIN2821：报表表格模板功能增强

* EOC端个性设置中的报表表格模板功能增强，在原来的基础上，增加支持脚本回调，并将脚本回调的结果以及页面本身的筛选和查询框数据加入到报表的模板配置中，使模板显示的结果更加定制化。

   <img alt=" " src={useBaseUrl('docimg/biaogemubanzengqiang1.png')} />

* 脚本回调可以像在SDC中一样写脚本来调用RESTful API，获的数据会在模板中增加一列显示出来，下图中脚本获得的值为在SDC配置中，所有无父节点的第一层用户

   <img alt=" " src={useBaseUrl('docimg/biaogemubanzengqiang2.png')} />

* 同时，在模板文件里，新加了这一列，让获得的值可以显示

  <img alt=" " src={useBaseUrl('docimg/biaogemubanzengqiang3.png')} />

* 效果如图

  <img alt=" " src={useBaseUrl('docimg/biaogemubanzengqiang4.png')} />

### PBIN2827：物料表缩略图显示小图

* 在物料表中，新建或编辑物料，选择物料图像后，物料图像的缩略图大小显示为小图，这样在物料和物料图像过多的时候，可以提高服务器的处理性能。

### PBIN2831：作业组库存操作属性支持导入

* 库操作功能增强，库存表里进行库操作时可以下载模板导入数据的功能，也可以在作业组库存操作属性中使用。同样的，每个操作类型都提供相应的模板下载，根据模板格式修改内容后导入数据即可。

  <img alt=" " src={useBaseUrl('docimg/zuoyezushuxingkucaozuo1.png')} />

* 库操作各类型的信息中，前方标红星的，在模板中也必须要正确填写才可以。

### PBIN2835：EOC排班表支持导入

* EOC端排班表功能增强，支持导入。首先提供了可导入的模板，在模板中进行编辑后，选择一个已创建的排班表，点击导入数据即可。

  <img alt=" " src={useBaseUrl('docimg/paibandaoru1.png')} />

  <img alt=" " src={useBaseUrl('docimg/paibandaoru2.png')} />

* 导入后会自动生成排班，可选择是否清空当前已创建排班表的排班，不清空则是原排班表加模板的排班。不属于当前组织单元的人员，不会生成在排班表中，即只会为属于当前组织单元的用户做自动排班，如果没有人员是属于当前组织单元的，不会清空原排班，新的自动排班无效并会有相应提示。

  <img alt=" " src={useBaseUrl('docimg/paibandaoru3.png')} />

  <img alt=" " src={useBaseUrl('docimg/paibandaoru4.png')} />

### PBIN2837：可选项脚本支持显示额外信息列

* 字符串类型的可选项脚本，当显示样式为单选树或多选树时，除了名称，还能显示出其他信息。

* 详细可参考[扩展例子](/系统扩展指南/扩展例子.md)中的【EOC选择属于某组织单元和某岗位的人，显示是否在岗（不在岗最后排列），显示在手工单数（顺序排列）】脚本。

### PBIN2859：增加操作和访问日志

### PBIN2871：图形可视化对接Thingsboard
